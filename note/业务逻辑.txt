一、业务逻辑

1、电商相关业务流程(tpshop)		
1）后台添加商品:选择分类与类型，类型又包含属性与规格
   属性:如：手机：操作系统、屏幕材质、尺寸、通话时长、待机时间
   规格：一个规格具有多个规格值，拿手机举例，如：网络（4G手机、3G手机）、内存（16G、64G）
   属性与规格区别：规格影响价格，属性与价格无关 
   spu与sku区别：就好比苹果6s有两个不同的内存（16G、64G），16G与64G是两个不同的sku,苹果6s是一个spu

   后台添加商品注意的地方：
	（1）添加商品时，同时往“商品规格价格库存表（tp_spec_goods_price）”插入数据：里面记录了不同规格对应的价格与库存
	（2）商品库存：	商品不同规格库存的总和
	（3）商品相册与规格图片是不一样的，商品相册表关联的是商品id，商品规格图片表关联的是规格值id

   
               
2)、商品相关表（8张表）：商品表、分类表、商品类型表，商品属性表，商品属性值表，商品规格表，商品规格值表、商品规格价格库存表

3)、未登录加入购物车：未登录时通过往cart表中插入sessionid来标识是哪个用户加入的购物车，当此用户登录后，根据cart表中的sessionid，把cart表中的用户id改为登录的用户id

4）购物车、下单、支付逻辑、库存
   购物车实现：
		（1）、获取商品详情页表单中的数据，ajax序列化提交到ajaxAddCart进行处理，如goods_id,goods_num,选中的规格（以键为规格名，值为规格值id的数组）如：
			<input type="radio"  rel="16G" name="goods_spec[内存]" value="13" checked="checked">
		（2）对于提交上来的数据，购物车这边先判断商品类型是普通商品还是促销活动商品（如：秒杀、团购），不同类型不同处理
		（3）把提交上来的的规格数组进行排序（sort），然后用_拼接，去“商品规格价格库存表”查询对应的规格价格
		（4）去购物车中查询相同的规格商品是否存在，如果存在就修改商品数量，否则就添加
   下单支付：
		（1）支付方式有四种：余额、第三方支付、积分、优惠券（没过期  并且 订单金额达到 优惠券指定标准）
		（2）订单提交，清空购物车


	
5）、秒杀、团购业务逻辑
     （1）抢购表设计(重要字段)：id、参加抢购的商品id、抢购价格、参加抢购的商品数量、每人限购数、开始时间、结束时间 、是否结束is_end
     （2）商品表添加两个字段：优惠活动id、优惠活动类型type（如:1为秒杀、2为团购、3为优惠促销）
     （3）如有设置商品活动，则商品详情页优先显示活动信息（如：抢购标题、抢购价、剩余时间），否则显示普通商品信息（如:价格）
     （4）不能参与抢购的情况：购买数量大于每人限购数、活动时间已结束

6）积分商城 
      （1）后台全局设置积分换算比例（point_rate）。如：1元 = 1积分       1元 = 10积分       1元 = 100积分
      （2）后台添加商品时，根据商品价来赠送积分（根据不同商品后台设置，exchange_integral）	
      （3）算法：$goods['shop_price']-（$goods['exchange_integral']/$point_rate）+$goods['exchange_integral']				
     

      
      	
7）、qq登录、微信登录业务逻辑


qq授权登录(oauth2.0)流程：
（1）、构造请求参数（如：app_id,app_secret,callback回调地址），调用接口，获取code授权码
(2)、根据code，调用相应接口，获取access_token
(3)、根据access_token,调用相应接口，获取用户openid
(4)、根据access_token与openid获取用户信息

